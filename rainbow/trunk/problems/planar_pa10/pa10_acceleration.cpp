#include <cmath>
#include <cstring>
#include "mex.h"

double	Q1,Q2,Q3,Q4,Q5,Q6,T1,T2,T3,T4,T5,T6,U1,U2,U3,U4,U5,U6;
double  U1p,U2p,U3p,U4p,U5p,U6p,z[560];

#define P_TRQ   prhs[0]     
#define P_Q     prhs[1]     
#define P_QP    prhs[2]     
#define P_QPP   plhs[0]  

void evaluate_zees();

/* ................................ MAIN ............................. */
void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray *prhs[])
{
    int nrows=0, ncols=0, n=0;
	double *pTorque=NULL, *pQ=NULL, *pQP=NULL, *pQPP=NULL;

    // Check input for correct number of rows and columns
    if (mxGetM( P_TRQ ) != 6)   mexErrMsgTxt("Not enough torques specified.");
    if (mxGetM( P_Q ) != 6)     mexErrMsgTxt("Not enough Qs specified.");
    if (mxGetM( P_QP ) != 6)    mexErrMsgTxt("Not enough Qps specified.");
 	
    if ( ( mxGetN( P_TRQ ) != mxGetN( P_Q ) ) || ( mxGetN( P_TRQ ) != mxGetN( P_QP ) ) )
        mexErrMsgTxt("U, Q, and QP must all have the same number of columns.");
    
    // Assign pointers to each input and output.
	pTorque = mxGetPr( P_TRQ );
	pQ  = mxGetPr( P_Q );
	pQP = mxGetPr( P_QP );
    
    // Create storage for solutions
    nrows = mxGetM(P_Q); ncols = mxGetN(P_Q);
	P_QPP = mxCreateDoubleMatrix(nrows, ncols, mxREAL);
	pQPP = mxGetPr(P_QPP);
    
    // Evaluate the EOM for each column in the input data
    for (n=0; n < ncols; ++n)
    {
        // Define joint torques from input
        T1 = *(pTorque + n*6);
        T2 = *(pTorque + n*6 + 1);
        T3 = *(pTorque + n*6 + 2);
		T4 = *(pTorque + n*6 + 3);
		T5 = *(pTorque + n*6 + 4);
		T6 = *(pTorque + n*6 + 5);
		
        // Define joint angles from input
        Q1 = *(pQ + n*6);
        Q2 = *(pQ + n*6 + 1);
        Q3 = *(pQ + n*6 + 2);
		Q4 = *(pQ + n*6 + 3);
		Q5 = *(pQ + n*6 + 4);
		Q6 = *(pQ + n*6 + 5);
	
        // Define joint velocities from input
        U1 = *(pQP + n*6);
        U2 = *(pQP + n*6 + 1);
        U3 = *(pQP + n*6 + 2);
		U3 = *(pQP + n*6 + 3);
		U3 = *(pQP + n*6 + 4);
		U3 = *(pQP + n*6 + 5);
        
		memset(z, 0, sizeof(double)*560);
        evaluate_zees();
        
        // Record output
        pQPP[n*6]       = U1p;
        pQPP[n*6 + 1]   = U2p;
        pQPP[n*6 + 2]   = U3p;
		pQPP[n*6 + 3]   = U4p;
		pQPP[n*6 + 4]   = U5p;
		pQPP[n*6 + 5]   = U6p;
    }
}

void evaluate_zees()
{  
	/* Model parameters from Chris' simulink models.
		inertia
			1: 0.13,0.10,0.50
			2: 0.49,0.49,0.45
			3: 0.49,0.49,0.50
			4: 0.19,0.01,0.01
			5: 0.01,0.01,0.18
			6: 0.01,0.01,0.06
		mass
			1: 9.29
			2: 12.43
			3: 4.86
			4: 3.08
			5: 2.07
			6: 1.05
		c = [9.08,9.28,5.81,1.48,1.84,0.87],
		v = [9.88,18.38,5.79,1.45,1.75,0.92],
		beta = 10
	*/
	const static double BETA = 10.0;
	const static double C1=9.08, C2=9.28, C3=5.81, C4=1.48, C5=1.84, C6=0.87;
	const static double G=9.801;
	const static double IA3=0.5;
	const static double IB1=0.49,IB2=0.49,IB3=0.45;
	const static double IC1=0.49,IC2=0.49,IC3=0.50;
	const static double ID1=0.19,ID2=0.01,ID3=0.01;
	const static double IE1=0.01,IE2=0.01,IE3=0.18;
	const static double IF1=0.01,IF2=0.01,IF3=0.06;
	const static double MB=12.43,MC=4.86,MD=3.08,ME=2.07,MF=1.05;
	const static double V1=9.88,V2=18.38,V3=5.79,V4=1.45,V5=1.75,V6=0.92;
	const static double Pi=4.0*atan(1.0),DEGtoRAD=Pi/180.0,RADtoDEG=180.0/Pi;
	
	double TF1=0.0,TF2=0.0,TF3=0.0,TF4=0.0,TF5=0.0,TF6=0.0;
	
/* Evaluate constants */
  z[1] = cos(Q1);
  z[2] = sin(Q1);
  z[13] = pow(z[1],2) + pow(z[2],2);
  z[3] = cos(Q2);
  z[5] = cos(Q3);
  z[4] = sin(Q2);
  z[6] = sin(Q3);
  z[27] = z[3]*z[5] - z[4]*z[6];
  z[33] = z[13]*z[27];
  z[7] = cos(Q4);
  z[8] = sin(Q4);
  z[16] = pow(z[7],2) + pow(z[8],2);
  z[295] = ID3*z[16];
  z[9] = cos(Q5);
  z[10] = sin(Q5);
  z[28] = -z[3]*z[6] - z[4]*z[5];
  z[41] = z[7]*z[28];
  z[69] = z[9]*z[27] + z[10]*z[41];
  z[83] = z[13]*z[69];
  z[82] = z[9]*z[16];
  z[317] = IE3*z[82];
  z[344] = IF3*z[82];
  z[11] = cos(Q6);
  z[43] = z[8]*z[28];
  z[12] = sin(Q6);
  z[67] = z[9]*z[41] - z[10]*z[27];
  z[103] = -z[11]*z[43] - z[12]*z[67];
  z[119] = z[13]*z[103];
  z[91] = z[10]*z[12];
  z[122] = z[16]*z[91];
  z[341] = IF2*z[122];
  z[59] = z[8]*z[9];
  z[22] = z[4]*z[13];
  z[31] = z[13]*z[28];
  z[131] = 0.45*z[22] - 0.48*z[31];
  z[139] = z[59]*z[131];
  z[54] = z[13]*z[43];
  z[151] = z[139] - 0.07000000000000001*z[54];
  z[134] = z[7]*z[131];
  z[76] = z[13]*z[67];
  z[154] = z[134] - 0.07000000000000001*z[76];
  z[157] = z[11]*z[151] + z[12]*z[154];
  z[165] = z[157] - 0.048*z[119];
  z[79] = z[10]*z[16];
  z[160] = z[12]*z[79];
  z[211] = 0.07000000000000001*z[160] - 0.048*z[122];
  z[162] = z[11]*z[154] - z[12]*z[151];
  z[101] = z[11]*z[67] - z[12]*z[43];
  z[113] = z[13]*z[101];
  z[168] = z[162] + 0.048*z[113];
  z[161] = z[11]*z[79];
  z[89] = z[10]*z[11];
  z[116] = z[16]*z[89];
  z[213] = 0.07000000000000001*z[161] - 0.048*z[116];
  z[310] = IE1*z[79];
  z[335] = IF1*z[116];
  z[148] = z[134] + 0.042*z[76];
  z[353] = z[33]*z[295] + z[83]*z[317] + z[83]*z[344] + z[119]*z[341] + MF*(
  z[165]*z[211]+z[168]*z[213]) - z[76]*z[310] - z[113]*z[335] - 0.042*ME*
  z[79]*z[148];
  z[296] = ID3*z[33];
  z[318] = IE3*z[83];
  z[345] = IF3*z[83];
  z[338] = IF2*z[119];
  z[307] = IE1*z[76];
  z[332] = IF1*z[113];
  z[374] = z[16]*z[296] + z[82]*z[318] + z[82]*z[345] + z[122]*z[338] + 
  0.04800000000000001*MF*(1.458333333333333*z[160]*z[165]+1.458333333333333*
  z[161]*z[168]-z[11]*z[79]*z[168]-z[12]*z[79]*z[165]) - z[79]*z[307] - 
  z[116]*z[332] - 0.042*ME*z[79]*z[148];
  z[252] = IA3*z[13];
  z[258] = IB1*z[22];
  z[24] = z[3]*z[13];
  z[261] = IB3*z[24];
  z[272] = IC1*z[31];
  z[276] = IC3*z[33];
  z[50] = z[13]*z[41];
  z[289] = ID1*z[50];
  z[293] = ID2*z[54];
  z[315] = IE2*z[54];
  z[129] = 0.4500000000000001*z[22] - 0.0485*z[31];
  z[181] = 0.45*z[22] - 0.0485*z[31];
  z[61] = z[8]*z[10];
  z[142] = z[61]*z[131];
  z[145] = z[139] + 0.042*z[54];
  z[132] = z[8]*z[131];
  z[189] = z[132] + 0.1122*z[54];
  z[191] = z[134] + 0.1122*z[50];
  z[29] = z[3]*z[6] + z[4]*z[5];
  z[136] = z[13]*z[29];
  z[125] = z[13]*(z[3]-4.300000000000001*z[4]);
  z[171] = 0.129*z[22] - 0.03*z[24];
  z[352] = z[13]*z[252] + z[22]*z[258] + z[24]*z[261] + z[31]*z[272] + z[33]*
  z[276] + z[33]*z[296] + z[50]*z[289] + z[54]*z[293] + z[54]*z[315] + z[76]*
  z[307] + z[83]*z[318] + z[83]*z[345] + z[113]*z[332] + z[119]*z[338] + MC*
  z[129]*z[181] + MF*(pow(z[142],2)+pow(z[165],2)+pow(z[168],2)) + 0.9999999999999999*
  ME*(pow(z[145],2)+pow(z[148],2)+1*pow(z[142],2)) + 0.1122*MD*(8.912655971479502*
  z[132]*z[189]+8.912655971479502*z[134]*z[191]-z[7]*z[136]*z[191]-z[8]*
  z[136]*z[189]) - 0.03*MB*z[125]*z[171];
  z[414] = z[374]/z[352];
  z[420] = z[13]*z[414];
  z[14] = pow(z[3],2) + pow(z[4],2);
  z[48] = z[8]*z[14];
  z[77] = z[14]*z[59];
  z[84] = z[14]*z[61];
  z[93] = z[7]*z[12] + z[11]*z[59];
  z[114] = z[14]*z[93];
  z[95] = z[7]*z[11] - z[12]*z[59];
  z[120] = z[14]*z[95];
  z[126] = z[5]*z[14];
  z[130] = 0.45*z[126] + 0.48*z[14];
  z[133] = z[7]*z[130];
  z[52] = z[7]*z[14];
  z[137] = z[133] - 0.1122*z[52];
  z[135] = z[8]*z[130];
  z[138] = 0.1122*z[48] - z[135];
  z[60] = z[7]*z[10];
  z[127] = z[6]*z[14];
  z[143] = z[60]*z[130] + 0.45*z[9]*z[127];
  z[58] = z[7]*z[9];
  z[141] = z[58]*z[130] - 0.45*z[10]*z[127];
  z[152] = z[141] + 0.07000000000000001*z[52];
  z[155] = -z[135] - 0.07000000000000001*z[77];
  z[158] = z[11]*z[152] + z[12]*z[155];
  z[166] = z[158] - 0.048*z[120];
  z[163] = z[11]*z[155] - z[12]*z[152];
  z[169] = z[163] + 0.048*z[114];
  z[146] = z[141] - 0.042*z[52];
  z[149] = 0.042*z[77] - z[135];
  z[361] = z[48]*z[289] + z[77]*z[307] + z[84]*z[318] + z[84]*z[345] + z[114]*
  z[332] + z[120]*z[338] + MD*(z[137]*z[189]+z[138]*z[191]) + MF*(z[142]*
  z[143]+z[165]*z[166]+z[168]*z[169]) + 0.9999999999999999*ME*(z[145]*z[146]+
  z[148]*z[149]+1*z[142]*z[143]) - z[52]*z[293] - z[52]*z[315];
  z[398] = z[361]/z[352];
  z[404] = z[13]*z[398];
  z[287] = ID1*z[48];
  z[308] = IE1*z[77];
  z[319] = IE3*z[84];
  z[346] = IF3*z[84];
  z[333] = IF1*z[114];
  z[339] = IF2*z[120];
  z[291] = ID2*z[52];
  z[313] = IE2*z[52];
  z[354] = z[50]*z[287] + z[76]*z[308] + z[83]*z[319] + z[83]*z[346] + z[113]*
  z[333] + z[119]*z[339] + MF*(z[142]*z[143]+z[165]*z[166]+z[168]*z[169]) + 
  0.9999999999999999*ME*(z[145]*z[146]+z[148]*z[149]+1*z[142]*z[143]) + 
  0.1122*MD*(8.912655971479502*z[132]*z[137]+8.912655971479502*z[134]*z[138]-
  z[7]*z[136]*z[138]-z[8]*z[136]*z[137]) - z[54]*z[291] - z[54]*z[313];
  z[375] = z[82]*z[319] + z[82]*z[346] + z[122]*z[339] + 0.04800000000000001*
  MF*(1.458333333333333*z[160]*z[166]+1.458333333333333*z[161]*z[169]-z[11]*
  z[79]*z[169]-z[12]*z[79]*z[166]) - z[79]*z[308] - z[116]*z[333] - 0.042*ME*
  z[79]*z[149];
  z[415] = z[354]*z[414] - z[375];
  z[260] = IB2*z[14];
  z[274] = IC2*z[14];
  z[128] = 0.0485*z[14] + 0.45*z[126];
  z[359] = z[14]*z[260] + z[14]*z[274] + z[48]*z[287] + z[52]*z[291] + z[52]*
  z[313] + z[77]*z[308] + z[84]*z[319] + z[84]*z[346] + z[114]*z[333] + 
  z[120]*z[339] + 0.01754100000000001*MB*pow(z[14],2) + 0.2025*MC*(pow(z[127],
  2)+4.93827160493827*pow(z[128],2)) + MF*(pow(z[143],2)+pow(z[166],2)+pow(
  z[169],2)) + 0.9999999999999999*ME*(pow(z[146],2)+pow(z[149],2)+1*pow(
  z[143],2)) + 0.2025*MD*(pow(z[127],2)+4.938271604938271*pow(z[137],2)+
  4.938271604938271*pow(z[138],2));
  z[399] = z[354]*z[398] - z[359];
  z[446] = z[415]/z[399];
  z[451] = z[420] - z[404]*z[446];
  z[15] = pow(z[5],2) + pow(z[6],2);
  z[49] = z[8]*z[15];
  z[78] = z[15]*z[59];
  z[85] = z[15]*z[61];
  z[115] = z[15]*z[93];
  z[121] = z[15]*z[95];
  z[144] = z[15]*z[60];
  z[140] = z[15]*z[58];
  z[53] = z[7]*z[15];
  z[147] = 0.48*z[140] - 0.042*z[53];
  z[150] = 0.042*z[78] - 0.48*z[49];
  z[153] = 0.07000000000000001*z[53] + 0.48*z[140];
  z[156] = -0.48*z[49] - 0.07000000000000001*z[78];
  z[159] = z[11]*z[153] + z[12]*z[156];
  z[167] = z[159] - 0.048*z[121];
  z[164] = z[11]*z[156] - z[12]*z[153];
  z[170] = z[164] + 0.048*z[115];
  z[368] = z[49]*z[289] + z[78]*z[307] + z[85]*z[318] + z[85]*z[345] + z[115]*
  z[332] + z[121]*z[338] + 0.48*ME*(z[142]*z[144]+2.083333333333333*z[145]*
  z[147]+2.083333333333333*z[148]*z[150]) + 0.48*MF*(z[142]*z[144]+2.083333333333333*
  z[165]*z[167]+2.083333333333333*z[168]*z[170]) - z[53]*z[293] - z[53]*
  z[315] - 0.1122*MD*(4.278074866310161*z[49]*z[191]+z[7]*z[15]*z[189]-4.278074866310161*
  z[53]*z[189]-z[8]*z[15]*z[191]);
  z[406] = z[368]/z[352];
  z[412] = z[13]*z[406];
  z[366] = z[15]*z[274] + z[49]*z[287] + z[53]*z[291] + z[53]*z[313] + z[78]*
  z[308] + z[85]*z[319] + z[85]*z[346] + z[115]*z[333] + z[121]*z[339] + 
  0.0485*MC*z[15]*z[128] + 0.48*ME*(z[143]*z[144]+2.083333333333333*z[146]*
  z[147]+2.083333333333333*z[149]*z[150]) + 0.48*MF*(z[143]*z[144]+2.083333333333333*
  z[166]*z[167]+2.083333333333333*z[169]*z[170]) - 0.1122*MD*(4.278074866310161*
  z[49]*z[138]+z[7]*z[15]*z[137]-4.278074866310161*z[53]*z[137]-z[8]*z[15]*
  z[138]);
  z[407] = z[354]*z[406] - z[366];
  z[438] = z[407]/z[399];
  z[443] = z[412] - z[404]*z[438];
  z[288] = ID1*z[49];
  z[309] = IE1*z[78];
  z[320] = IE3*z[85];
  z[347] = IF3*z[85];
  z[334] = IF1*z[115];
  z[340] = IF2*z[121];
  z[292] = ID2*z[53];
  z[314] = IE2*z[53];
  z[355] = z[50]*z[288] + z[76]*z[309] + z[83]*z[320] + z[83]*z[347] + z[113]*
  z[334] + z[119]*z[340] + 0.48*ME*(z[142]*z[144]+2.083333333333333*z[145]*
  z[147]+2.083333333333333*z[148]*z[150]) + 0.48*MF*(z[142]*z[144]+2.083333333333334*
  z[165]*z[167]+2.083333333333334*z[168]*z[170]) + 0.04126716*MD*(8.912655971479502*
  z[53]*z[132]+z[7]*z[49]*z[136]-8.912655971479502*z[49]*z[134]-z[8]*z[53]*
  z[136]) - z[54]*z[292] - z[54]*z[314];
  z[376] = z[82]*z[320] + z[82]*z[347] + z[122]*z[340] + 0.04800000000000001*
  MF*(1.458333333333333*z[160]*z[167]+1.458333333333333*z[161]*z[170]-z[11]*
  z[79]*z[170]-z[12]*z[79]*z[167]) - z[79]*z[309] - z[116]*z[334] - 0.042*ME*
  z[79]*z[150];
  z[416] = z[355]*z[414] - z[376];
  z[275] = IC2*z[15];
  z[360] = z[14]*z[275] + z[48]*z[288] + z[52]*z[292] + z[52]*z[314] + z[77]*
  z[309] + z[84]*z[320] + z[84]*z[347] + z[114]*z[334] + z[120]*z[340] + 
  0.0485*MC*z[15]*z[128] + 0.48*ME*(z[143]*z[144]+2.083333333333333*z[146]*
  z[147]+2.083333333333333*z[149]*z[150]) + 0.48*MF*(z[143]*z[144]+2.083333333333334*
  z[166]*z[167]+2.083333333333334*z[169]*z[170]) - 0.3678*MD*(z[49]*z[138]-
  z[53]*z[137]);
  z[400] = z[355]*z[398] - z[360];
  z[447] = z[416] - z[400]*z[446];
  z[367] = z[15]*z[275] + z[49]*z[288] + z[53]*z[292] + z[53]*z[314] + z[78]*
  z[309] + z[85]*z[320] + z[85]*z[347] + z[115]*z[334] + z[121]*z[340] + 
  0.00235225*MC*pow(z[15],2) + 0.2304*ME*(pow(z[144],2)+4.340277777777778*
  pow(z[147],2)+4.340277777777778*pow(z[150],2)) + 0.2304*MF*(pow(z[144],2)+
  4.340277777777778*pow(z[167],2)+4.340277777777778*pow(z[170],2)) + 0.04126716*
  MD*(4.278074866310161*pow(z[49],2)+4.278074866310161*pow(z[53],2)-z[7]*
  z[15]*z[53]-z[8]*z[15]*z[49]);
  z[408] = z[355]*z[406] - z[367];
  z[439] = z[408] - z[400]*z[438];
  z[470] = z[447]/z[439];
  z[474] = z[451] - z[443]*z[470];
  z[17] = pow(z[9],2) + pow(z[10],2);
  z[112] = z[12]*z[17];
  z[331] = IF1*z[112];
  z[118] = z[11]*z[17];
  z[337] = IF2*z[118];
  z[312] = IE2*z[17];
  z[356] = z[113]*z[331] + z[119]*z[337] - z[54]*z[312] - 0.042*ME*z[17]*
  z[145] - 0.02200000000000001*MF*(z[112]*z[168]-z[118]*z[165]);
  z[378] = z[122]*z[337] + 0.001056*MF*(1.458333333333334*z[118]*z[160]+z[11]*
  z[79]*z[112]-1.458333333333334*z[112]*z[161]-z[12]*z[79]*z[118]) - z[116]*
  z[331];
  z[418] = z[356]*z[414] - z[378];
  z[363] = z[52]*z[312] + z[114]*z[331] + z[120]*z[337] - 0.042*ME*z[17]*
  z[146] - 0.02200000000000001*MF*(z[112]*z[169]-z[118]*z[166]);
  z[402] = z[356]*z[398] - z[363];
  z[449] = z[418] - z[402]*z[446];
  z[370] = z[53]*z[312] + z[115]*z[331] + z[121]*z[337] - 0.042*ME*z[17]*
  z[147] - 0.02200000000000001*MF*(z[112]*z[170]-z[118]*z[167]);
  z[410] = z[356]*z[406] - z[370];
  z[441] = z[410] - z[402]*z[438];
  z[472] = z[449] - z[441]*z[470];
  z[383] = z[112]*z[332] + z[118]*z[338] - z[17]*z[315] - 0.042*ME*z[17]*
  z[145] - 0.04800000000000001*MF*(1.458333333333333*z[112]*z[168]+z[11]*
  z[17]*z[165]-1.458333333333333*z[118]*z[165]-z[12]*z[17]*z[168]);
  z[422] = z[383]/z[352];
  z[428] = z[13]*z[422];
  z[381] = z[17]*z[313] + z[112]*z[333] + z[118]*z[339] - 0.042*ME*z[17]*
  z[146] - 0.04800000000000001*MF*(1.458333333333333*z[112]*z[169]+z[11]*
  z[17]*z[166]-1.458333333333333*z[118]*z[166]-z[12]*z[17]*z[169]);
  z[423] = z[354]*z[422] - z[381];
  z[454] = z[423]/z[399];
  z[459] = z[428] - z[404]*z[454];
  z[382] = z[17]*z[314] + z[112]*z[334] + z[118]*z[340] - 0.042*ME*z[17]*
  z[147] - 0.04800000000000001*MF*(1.458333333333333*z[112]*z[170]+z[11]*
  z[17]*z[167]-1.458333333333333*z[118]*z[167]-z[12]*z[17]*z[170]);
  z[424] = z[355]*z[422] - z[382];
  z[455] = z[424] - z[400]*z[454];
  z[478] = z[455]/z[439];
  z[482] = z[459] - z[443]*z[478];
  z[384] = z[118]*z[341] - z[112]*z[335] - 0.04800000000000001*MF*(1.458333333333333*
  z[112]*z[213]+z[11]*z[17]*z[211]-1.458333333333333*z[118]*z[211]-z[12]*
  z[17]*z[213]);
  z[425] = z[353]*z[422] - z[384];
  z[362] = z[84]*z[317] + z[84]*z[344] + z[120]*z[341] + MF*(z[166]*z[211]+
  z[169]*z[213]) - z[77]*z[310] - z[114]*z[335] - 0.042*ME*z[79]*z[149];
  z[401] = z[353]*z[398] - z[362];
  z[456] = z[425] - z[401]*z[454];
  z[369] = z[85]*z[317] + z[85]*z[344] + z[121]*z[341] + MF*(z[167]*z[211]+
  z[170]*z[213]) - z[78]*z[310] - z[115]*z[335] - 0.042*ME*z[79]*z[150];
  z[409] = z[353]*z[406] - z[369];
  z[440] = z[409] - z[401]*z[438];
  z[479] = z[456] - z[440]*z[478];
  z[373] = z[16]*z[295] + z[79]*z[310] + z[82]*z[317] + z[82]*z[344] + z[116]*
  z[335] + z[122]*z[341] + 0.001764*ME*pow(z[79],2) + 0.04800000000000001*MF*(
  1.458333333333333*z[160]*z[211]+1.458333333333333*z[161]*z[213]-z[11]*z[79]*
  z[213]-z[12]*z[79]*z[211]);
  z[417] = z[353]*z[414] - z[373];
  z[448] = z[417] - z[401]*z[446];
  z[471] = z[448] - z[440]*z[470];
  z[494] = z[479]/z[471];
  z[497] = z[482] - z[474]*z[494];
  z[18] = pow(z[11],2) + pow(z[12],2);
  z[343] = IF3*z[18];
  z[357] = z[83]*z[343];
  z[427] = z[357]*z[422];
  z[364] = z[84]*z[343];
  z[403] = z[357]*z[398] - z[364];
  z[458] = z[427] - z[403]*z[454];
  z[371] = z[85]*z[343];
  z[411] = z[357]*z[406] - z[371];
  z[442] = z[411] - z[403]*z[438];
  z[481] = z[458] - z[442]*z[478];
  z[377] = z[82]*z[343];
  z[419] = z[357]*z[414] - z[377];
  z[450] = z[419] - z[403]*z[446];
  z[473] = z[450] - z[442]*z[470];
  z[496] = z[481] - z[473]*z[494];
  z[388] = z[18]*z[345];
  z[430] = z[388]/z[352];
  z[436] = z[13]*z[430];
  z[389] = z[18]*z[346];
  z[431] = z[354]*z[430] - z[389];
  z[462] = z[431]/z[399];
  z[467] = z[436] - z[404]*z[462];
  z[390] = z[18]*z[347];
  z[432] = z[355]*z[430] - z[390];
  z[463] = z[432] - z[400]*z[462];
  z[486] = z[463]/z[439];
  z[490] = z[467] - z[443]*z[486];
  z[387] = z[18]*z[344];
  z[433] = z[353]*z[430] - z[387];
  z[464] = z[433] - z[401]*z[462];
  z[487] = z[464] - z[440]*z[486];
  z[502] = z[487]/z[471];
  z[505] = z[490] - z[474]*z[502];
  z[434] = z[356]*z[430];
  z[465] = z[434] - z[402]*z[462];
  z[488] = z[465] - z[441]*z[486];
  z[503] = z[488] - z[472]*z[502];
  z[380] = z[17]*z[312] + z[112]*z[331] + z[118]*z[337] + 0.001764*ME*pow(
  z[17],2) + 0.001056*MF*(1.458333333333334*pow(z[112],2)+1.458333333333334*
  pow(z[118],2)-z[11]*z[17]*z[118]-z[12]*z[17]*z[112]);
  z[426] = z[356]*z[422] - z[380];
  z[457] = z[426] - z[402]*z[454];
  z[480] = z[457] - z[441]*z[478];
  z[495] = z[480] - z[472]*z[494];
  z[510] = z[503]/z[495];
  z[512] = z[505] - z[497]*z[510];
  z[386] = z[18]*z[343];
  z[435] = z[357]*z[430] - z[386];
  z[466] = z[435] - z[403]*z[462];
  z[489] = z[466] - z[442]*z[486];
  z[504] = z[489] - z[473]*z[502];
  z[511] = z[504] - z[496]*z[510];
  z[519] = z[512]/z[511];
  z[526] = (z[497]-z[496]*z[519])/z[495];
  z[533] = (z[474]-z[472]*z[526]-z[473]*z[519])/z[471];
  z[540] = (z[443]-z[440]*z[533]-z[441]*z[526]-z[442]*z[519])/z[439];
  z[547] = (z[404]-z[400]*z[540]-z[401]*z[533]-z[402]*z[526]-z[403]*z[519])/
  z[399];
  z[553] = (z[13]-z[353]*z[533]-z[354]*z[547]-z[355]*z[540]-z[356]*z[526]-
  z[357]*z[519])/z[352];
  z[444] = z[14]*z[438];
  z[452] = z[14]*z[446];
  z[475] = z[452] - z[444]*z[470];
  z[460] = z[14]*z[454];
  z[483] = z[460] - z[444]*z[478];
  z[498] = z[483] - z[475]*z[494];
  z[468] = z[14]*z[462];
  z[491] = z[468] - z[444]*z[486];
  z[506] = z[491] - z[475]*z[502];
  z[513] = z[506] - z[498]*z[510];
  z[520] = z[513]/z[511];
  z[527] = (z[498]-z[496]*z[520])/z[495];
  z[534] = (z[475]-z[472]*z[527]-z[473]*z[520])/z[471];
  z[541] = (z[444]-z[440]*z[534]-z[441]*z[527]-z[442]*z[520])/z[439];
  z[546] = (z[14]+z[400]*z[541]+z[401]*z[534]+z[402]*z[527]+z[403]*z[520])/
  z[399];
  z[555] = (z[354]*z[546]-z[353]*z[534]-z[355]*z[541]-z[356]*z[527]-z[357]*
  z[520])/z[352];
  z[476] = z[15]*z[470];
  z[484] = z[15]*z[478];
  z[499] = z[484] - z[476]*z[494];
  z[492] = z[15]*z[486];
  z[507] = z[492] - z[476]*z[502];
  z[514] = z[507] - z[499]*z[510];
  z[521] = z[514]/z[511];
  z[528] = (z[499]-z[496]*z[521])/z[495];
  z[535] = (z[476]-z[472]*z[528]-z[473]*z[521])/z[471];
  z[539] = (z[15]+z[440]*z[535]+z[441]*z[528]+z[442]*z[521])/z[439];
  z[549] = (z[400]*z[539]-z[401]*z[535]-z[402]*z[528]-z[403]*z[521])/z[399];
  z[556] = (z[355]*z[539]-z[353]*z[535]-z[354]*z[549]-z[356]*z[528]-z[357]*
  z[521])/z[352];
  z[500] = z[16]*z[494];
  z[508] = z[16]*z[502];
  z[515] = z[508] - z[500]*z[510];
  z[522] = z[515]/z[511];
  z[529] = (z[500]-z[496]*z[522])/z[495];
  z[532] = (z[16]+z[472]*z[529]+z[473]*z[522])/z[471];
  z[543] = (z[440]*z[532]-z[441]*z[529]-z[442]*z[522])/z[439];
  z[550] = (z[401]*z[532]-z[400]*z[543]-z[402]*z[529]-z[403]*z[522])/z[399];
  z[557] = (z[353]*z[532]-z[354]*z[550]-z[355]*z[543]-z[356]*z[529]-z[357]*
  z[522])/z[352];
  z[516] = z[17]*z[510];
  z[523] = z[516]/z[511];
  z[525] = (z[17]+z[496]*z[523])/z[495];
  z[537] = (z[472]*z[525]-z[473]*z[523])/z[471];
  z[544] = (z[441]*z[525]-z[440]*z[537]-z[442]*z[523])/z[439];
  z[551] = (z[402]*z[525]-z[400]*z[544]-z[401]*z[537]-z[403]*z[523])/z[399];
  z[558] = (z[356]*z[525]-z[353]*z[537]-z[354]*z[551]-z[355]*z[544]-z[357]*
  z[523])/z[352];
  TF4 = V4*U4 + C4*tanh(BETA*U4);
  TF5 = V5*U5 + C5*tanh(BETA*U5);
  TF6 = V6*U6 + C6*tanh(BETA*U6);
  z[224] = G*ME;
  TF1 = V1*U1 + C1*tanh(BETA*U1);
  z[223] = G*MD;
  z[225] = G*MF;
  z[246] = TF4*z[13]*z[27] + z[13]*(TF5*z[43]+TF6*z[69]) + z[224]*(z[43]*
  z[148]-z[67]*z[145]-z[69]*z[142]) - TF1*z[13] - TF6*z[13]*z[69] - z[13]*(
  TF4*z[27]+TF5*z[43]) - z[223]*(z[41]*z[132]-z[43]*z[134]) - z[225]*(z[69]*
  z[142]+z[101]*z[165]+z[103]*z[168]);
  z[19] = z[13]*U1;
  z[20] = z[14]*U2;
  z[21] = z[19]*z[20];
  z[23] = z[3]*z[21];
  z[259] = IB1*z[23];
  z[253] = z[22]*U1;
  z[255] = IB1*z[253];
  z[257] = IB2*z[20];
  z[264] = z[20]*z[255] - z[253]*z[257];
  z[268] = z[14]*U2 + z[15]*U3;
  z[267] = z[33]*U1;
  z[270] = IC3*z[267];
  z[271] = IC2*z[268];
  z[280] = z[268]*z[270] - z[267]*z[271];
  z[266] = z[31]*U1;
  z[269] = IC1*z[266];
  z[279] = z[266]*z[271] - z[268]*z[269];
  z[35] = z[16]*U4;
  z[45] = z[5]*z[20]*z[35];
  z[46] = z[6]*z[20]*z[35];
  z[26] = z[15]*U3;
  z[30] = z[19]*(z[20]+z[26]);
  z[56] = z[6]*z[45] - z[5]*z[46] - z[29]*z[30];
  z[297] = ID3*z[56];
  z[281] = z[48]*U2 + z[49]*U3 + z[50]*U1;
  z[282] = z[52]*U2 + z[53]*U3 - z[54]*U1;
  z[285] = ID2*z[282];
  z[284] = ID1*z[281];
  z[298] = z[281]*z[285] - z[282]*z[284];
  z[47] = z[26]*z[35];
  z[44] = z[29]*z[19]*z[35];
  z[36] = z[5]*z[7];
  z[37] = z[6]*z[7];
  z[40] = z[7]*z[27];
  z[51] = z[7]*z[47] + z[8]*z[44] + z[36]*z[45] + z[37]*z[46] - z[40]*z[30];
  z[290] = ID1*z[51];
  z[283] = z[16]*U4 + z[33]*U1;
  z[286] = ID3*z[283];
  z[300] = z[282]*z[286] - z[283]*z[285];
  z[42] = z[8]*z[27];
  z[57] = z[17]*U5;
  z[71] = z[19]*(z[29]*z[35]-z[42]*z[57]);
  z[62] = z[9]*z[36] - z[6]*z[10];
  z[39] = z[6]*z[8];
  z[72] = z[20]*(z[5]*z[35]+z[39]*z[57]);
  z[75] = z[35]*z[57];
  z[74] = z[8]*z[26]*z[57];
  z[63] = -z[5]*z[10] - z[9]*z[37];
  z[38] = z[5]*z[8];
  z[73] = z[20]*(z[6]*z[35]-z[38]*z[57]);
  z[66] = z[9]*z[40] - z[10]*z[29];
  z[70] = z[19]*(z[20]+z[26]+z[7]*z[57]);
  z[80] = z[58]*z[47] + z[59]*z[71] + z[62]*z[72] - z[9]*z[75] - z[10]*z[74] - 
  z[63]*z[73] - z[66]*z[70];
  z[311] = IE1*z[80];
  z[302] = z[17]*U5 + z[52]*U2 + z[53]*U3 - z[54]*U1;
  z[303] = z[82]*U4 + z[83]*U1 + z[84]*U2 + z[85]*U3;
  z[306] = IE3*z[303];
  z[305] = IE2*z[302];
  z[324] = z[302]*z[306] - z[303]*z[305];
  z[64] = z[6]*z[9] + z[10]*z[36];
  z[65] = z[5]*z[9] - z[10]*z[37];
  z[68] = z[9]*z[29] + z[10]*z[40];
  z[86] = z[9]*z[74] + z[60]*z[47] + z[61]*z[71] + z[64]*z[72] - z[10]*z[75] - 
  z[65]*z[73] - z[68]*z[70];
  z[321] = IE3*z[86];
  z[301] = z[76]*U1 + z[77]*U2 + z[78]*U3 - z[79]*U4;
  z[304] = IE1*z[301];
  z[322] = z[301]*z[305] - z[302]*z[304];
  z[87] = z[18]*U6;
  z[109] = z[26]*(z[8]*z[57]-z[60]*z[87]);
  z[108] = z[26]*(z[35]+z[9]*z[87]);
  z[106] = z[20]*(z[5]*z[35]+z[39]*z[57]+z[65]*z[87]);
  z[107] = z[20]*(z[38]*z[57]-z[6]*z[35]-z[64]*z[87]);
  z[105] = z[19]*(z[42]*z[57]-z[29]*z[35]-z[68]*z[87]);
  z[104] = z[19]*(z[20]+z[26]+z[7]*z[57]+z[61]*z[87]);
  z[124] = z[9]*z[109] + z[60]*z[108] + z[64]*z[106] + z[65]*z[107] - z[10]*
  z[75] - z[61]*z[105] - z[68]*z[104];
  z[348] = IF3*z[124];
  z[325] = z[112]*U5 + z[113]*U1 + z[114]*U2 + z[115]*U3 - z[116]*U4;
  z[326] = z[118]*U5 + z[119]*U1 + z[120]*U2 + z[121]*U3 + z[122]*U4;
  z[329] = IF2*z[326];
  z[328] = IF1*z[325];
  z[349] = z[325]*z[329] - z[326]*z[328];
  z[111] = z[57]*z[87];
  z[110] = z[10]*z[35]*z[87];
  z[92] = z[11]*z[58] - z[8]*z[12];
  z[96] = z[11]*z[62] - z[12]*z[38];
  z[97] = z[11]*z[63] + z[12]*z[39];
  z[88] = z[9]*z[11];
  z[100] = z[11]*z[66] - z[12]*z[42];
  z[117] = z[11]*z[111] + z[12]*z[110] + z[92]*z[108] + z[96]*z[106] + z[97]*
  z[107] - z[88]*z[75] - z[89]*z[109] - z[93]*z[105] - z[100]*z[104];
  z[336] = IF1*z[117];
  z[327] = z[18]*U6 + z[82]*U4 + z[83]*U1 + z[84]*U2 + z[85]*U3;
  z[330] = IF3*z[327];
  z[351] = z[326]*z[330] - z[327]*z[329];
  z[90] = z[9]*z[12];
  z[94] = -z[8]*z[11] - z[12]*z[58];
  z[98] = -z[11]*z[38] - z[12]*z[62];
  z[99] = z[11]*z[39] - z[12]*z[63];
  z[102] = -z[11]*z[42] - z[12]*z[66];
  z[123] = z[11]*z[110] + z[90]*z[75] + z[91]*z[109] + z[94]*z[108] + z[98]*
  z[106] + z[99]*z[107] - z[12]*z[111] - z[95]*z[105] - z[102]*z[104];
  z[342] = IF2*z[123];
  z[350] = z[327]*z[328] - z[325]*z[330];
  z[176] = 0.45*z[23] + 0.45*z[3]*z[14]*U2*z[19];
  z[32] = z[27]*z[30];
  z[182] = z[176] + 0.0485*z[32] + 0.0485*z[27]*(z[14]*U2+z[15]*U3)*z[19];
  z[174] = z[14]*U2*z[20];
  z[177] = z[22]*U1*z[19];
  z[179] = -0.45*z[5]*z[174] - 0.45*z[29]*z[177];
  z[184] = z[179] - 0.48*(z[14]*U2+z[15]*U3)*(z[20]+z[26]);
  z[178] = 0.45*z[6]*z[174] - 0.45*z[27]*z[177];
  z[185] = z[176] + 0.48*z[32] + 0.48*z[27]*(z[14]*U2+z[15]*U3)*z[19];
  z[183] = z[31]*U1*z[19];
  z[199] = z[9]*z[184] + z[60]*z[178] + z[61]*z[185] + 0.48*z[68]*z[183];
  z[202] = z[199] + 0.042*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*z[57] + 0.042*
  z[7]*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*z[20] + 0.042*z[7]*(z[17]*U5+
  z[52]*U2+z[53]*U3-z[54]*U1)*z[26] + 0.042*z[59]*(z[76]*U1+z[77]*U2+z[78]*U3-
  z[79]*U4)*z[20] + 0.042*z[67]*(z[76]*U1+z[77]*U2+z[78]*U3-z[79]*U4)*z[19] - 
  0.042*z[43]*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*z[19];
  z[198] = z[58]*z[178] + z[59]*z[185] + 0.48*z[66]*z[183] - z[10]*z[184];
  z[81] = z[7]*z[71] + z[42]*z[70] - z[8]*z[47] - z[38]*z[72] - z[39]*z[73];
  z[200] = z[198] - 0.042*z[81] - 0.042*(z[76]*U1+z[77]*U2+z[78]*U3-z[79]*U4)*(
  z[61]*z[20]+z[69]*z[19]);
  z[187] = z[7]*z[185] - z[8]*z[178] - 0.48*z[42]*z[183];
  z[201] = z[187] + 0.042*z[80] - 0.042*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*(
  z[9]*z[35]+z[61]*z[20]+z[61]*z[26]+z[69]*z[19]);
  z[204] = z[8]*(z[76]*U1+z[77]*U2+z[78]*U3-z[79]*U4)*z[26];
  z[203] = (z[76]*U1+z[77]*U2+z[78]*U3-z[79]*U4)*z[35];
  z[219] = z[17]*U5*(z[57]+z[7]*z[20]+z[7]*z[26]-z[43]*z[19]);
  z[207] = z[199] + 0.07000000000000001*z[43]*(z[17]*U5+z[52]*U2+z[53]*U3-
  z[54]*U1)*z[19] - 0.07000000000000001*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*
  z[57] - 0.07000000000000001*z[7]*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*
  z[20] - 0.07000000000000001*z[7]*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*
  z[26] - 0.07000000000000001*z[59]*(z[76]*U1+z[77]*U2+z[78]*U3-z[79]*U4)*
  z[20] - 0.07000000000000001*z[67]*(z[76]*U1+z[77]*U2+z[78]*U3-z[79]*U4)*
  z[19];
  z[210] = z[207] + 0.07000000000000001*z[10]*z[203] - 0.07000000000000001*
  z[9]*z[204];
  z[215] = z[210] + 0.048*z[11]*(z[119]*U1+z[120]*U2+z[121]*U3)*z[57] + 0.048*
  z[12]*(z[113]*U1+z[114]*U2+z[115]*U3)*z[57] + 0.048*z[91]*(z[119]*U1+z[120]*
  U2+z[121]*U3)*z[35] + 0.048*z[93]*(z[113]*U1+z[114]*U2+z[115]*U3)*z[20] + 
  0.048*z[93]*(z[113]*U1+z[114]*U2+z[115]*U3)*z[26] + 0.048*z[95]*(z[119]*U1+
  z[120]*U2+z[121]*U3)*z[20] + 0.048*z[95]*(z[119]*U1+z[120]*U2+z[121]*U3)*
  z[26] + 0.048*z[101]*(z[113]*U1+z[114]*U2+z[115]*U3)*z[19] + 0.048*z[103]*(
  z[119]*U1+z[120]*U2+z[121]*U3)*z[19] - 0.048*z[89]*(z[113]*U1+z[114]*U2+
  z[115]*U3)*z[35];
  z[205] = z[198] + 0.07000000000000001*z[81] + 0.07000000000000001*(z[76]*U1+
  z[77]*U2+z[78]*U3-z[79]*U4)*(z[61]*z[20]+z[69]*z[19]);
  z[206] = z[187] + 0.07000000000000001*(z[17]*U5+z[52]*U2+z[53]*U3-z[54]*U1)*(
  z[9]*z[35]+z[61]*z[20]+z[61]*z[26]+z[69]*z[19]) - 0.07000000000000001*z[80];
  z[208] = z[11]*z[205] + z[12]*z[206] + 0.07000000000000001*z[88]*z[203] + 
  0.07000000000000001*z[89]*z[204];
  z[212] = z[208] - 0.048*z[123] - 0.048*(z[113]*U1+z[114]*U2+z[115]*U3)*(
  z[87]+z[9]*z[35]+z[61]*z[20]+z[61]*z[26]+z[69]*z[19]);
  z[209] = z[11]*z[206] - z[12]*z[205] - 0.07000000000000001*z[90]*z[203] - 
  0.07000000000000001*z[91]*z[204];
  z[214] = z[209] + 0.048*z[117] - 0.048*(z[119]*U1+z[120]*U2+z[121]*U3)*(
  z[87]+z[9]*z[35]+z[61]*z[20]+z[61]*z[26]+z[69]*z[19]);
  z[217] = z[79]*U4*(z[35]+z[9]*z[87]+z[27]*z[19]);
  z[218] = z[79]*U4*(z[8]*z[20]+z[8]*z[26]+z[10]*z[87]+z[41]*z[19]);
  z[216] = z[17]*U5*(z[87]+z[9]*z[35]+z[61]*z[20]+z[61]*z[26]+z[69]*z[19]);
  z[254] = z[24]*U1;
  z[256] = IB3*z[254];
  z[265] = z[20]*z[256] - z[254]*z[257];
  z[25] = z[4]*z[21];
  z[262] = IB3*z[25];
  z[273] = IC1*z[32];
  z[34] = z[29]*z[30];
  z[277] = IC3*z[34];
  z[55] = z[7]*z[44] + z[42]*z[30] - z[8]*z[47] - z[38]*z[45] - z[39]*z[46];
  z[294] = ID2*z[55];
  z[299] = z[283]*z[284] - z[281]*z[286];
  z[316] = IE2*z[81];
  z[323] = z[303]*z[304] - z[301]*z[306];
  z[172] = 0.03*z[25] + 0.129*z[23];
  z[173] = z[172] + 0.03*z[14]*(z[4]+4.300000000000001*z[3])*U2*z[19];
  z[194] = z[15]*U3*(z[35]+z[27]*z[19]);
  z[192] = z[187] + 0.1122*z[51] - 0.1122*z[52]*U2*(z[35]+z[27]*z[19]);
  z[186] = z[7]*z[178] + z[8]*z[185] + 0.48*z[40]*z[183];
  z[190] = z[186] - 0.1122*z[55] - 0.1122*z[48]*U2*(z[35]+z[27]*z[19]);
  z[196] = z[29]*z[136]*U1*z[35];
  z[195] = z[136]*U1*(z[19]+z[27]*z[35]);
  z[358] = z[22]*z[259] + z[24]*z[264] + z[31]*z[280] + z[33]*z[279] + z[33]*
  z[297] + z[33]*z[298] + z[50]*z[290] + z[50]*z[300] + z[76]*z[311] + z[76]*
  z[324] + z[83]*z[321] + z[83]*z[322] + z[83]*z[348] + z[83]*z[349] + z[113]*
  z[336] + z[113]*z[351] + z[119]*z[342] + z[119]*z[350] + MC*z[129]*z[182] + 
  0.042*ME*(23.80952380952381*z[142]*z[202]+23.80952380952381*z[145]*z[200]+
  23.80952380952381*z[148]*z[201]+z[9]*z[142]*z[204]-z[9]*z[145]*z[203]-z[10]*
  z[142]*z[203]-z[10]*z[145]*z[204]) + 0.048*MF*(z[142]*z[219]+20.83333333333333*
  z[142]*z[215]+20.83333333333333*z[165]*z[212]+20.83333333333333*z[168]*
  z[214]+z[10]*z[142]*z[217]+z[88]*z[165]*z[217]+z[89]*z[165]*z[218]-z[9]*
  z[142]*z[218]-z[11]*z[168]*z[216]-z[12]*z[165]*z[216]-z[90]*z[168]*z[217]-
  z[91]*z[168]*z[218]) - z[22]*z[265] - z[24]*z[262] - z[31]*z[273] - z[33]*
  z[277] - z[54]*z[294] - z[54]*z[299] - z[54]*z[316] - z[54]*z[323] - 0.03*
  MB*z[125]*z[173] - 0.01258884*MD*(8.912655971479502*z[7]*z[134]*z[194]+
  8.912655971479502*z[7]*z[136]*z[192]+8.912655971479502*z[8]*z[132]*z[194]+
  8.912655971479502*z[8]*z[136]*z[190]+8.912655971479502*z[41]*z[132]*z[196]+
  8.912655971479502*z[42]*z[134]*z[195]-79.43543646594921*z[132]*z[190]-
  79.43543646594921*z[134]*z[192]-z[136]*z[194]-8.912655971479502*z[40]*
  z[132]*z[195]-8.912655971479502*z[43]*z[134]*z[196]);
  z[392] = z[246] - z[358];
  z[249] = -TF4*z[16] - 0.042*z[224]*z[43]*z[79] - 0.048*z[225]*(z[43]*z[79]+
  1.458333333333334*z[101]*z[160]+1.458333333333334*z[103]*z[161]);
  z[379] = z[82]*z[321] + z[82]*z[322] + z[82]*z[348] + z[82]*z[349] + z[122]*
  z[342] + z[122]*z[350] + z[16]*(z[297]+z[298]) + 0.002304*MF*(z[79]*z[216]+
  30.38194444444445*z[160]*z[212]+30.38194444444445*z[161]*z[214]+1.458333333333334*
  z[88]*z[160]*z[217]+1.458333333333334*z[89]*z[160]*z[218]-20.83333333333334*
  z[11]*z[79]*z[214]-20.83333333333334*z[12]*z[79]*z[212]-1.458333333333334*
  z[11]*z[161]*z[216]-1.458333333333334*z[12]*z[160]*z[216]-1.458333333333334*
  z[90]*z[161]*z[217]-1.458333333333334*z[91]*z[161]*z[218]) - z[79]*z[311] - 
  z[79]*z[324] - z[116]*z[336] - z[116]*z[351] - 0.042*ME*z[79]*z[201];
  z[395] = z[249] - z[379];
  z[421] = z[414]*z[392] - z[395];
  TF3 = V3*U3 + C3*tanh(BETA*U3);
  TF2 = V2*U2 + C2*tanh(BETA*U2);
  z[221] = G*MB;
  z[222] = G*MC;
  z[247] = TF5*z[7]*z[14] + z[224]*(z[43]*z[149]-z[67]*z[146]-z[69]*z[143]) - 
  TF3*z[14] - TF6*z[14]*z[61] - (TF2-TF3)*z[14] - 0.03*z[221]*z[14]*(z[3]-
  4.300000000000001*z[4]) - z[14]*(TF5*z[7]-TF6*z[61]) - 0.45*z[222]*(z[27]*
  z[127]+2.222222222222222*z[28]*z[128]) - z[225]*(z[69]*z[143]+z[101]*z[166]+
  z[103]*z[169]) - 0.45*z[223]*(z[27]*z[127]+2.222222222222222*z[41]*z[137]-
  2.222222222222222*z[43]*z[138]);
  z[263] = z[253]*z[256] - z[254]*z[255];
  z[278] = z[267]*z[269] - z[266]*z[270];
  z[180] = z[179] - 0.0485*(z[14]*U2+z[15]*U3)*(z[20]+z[26]);
  z[175] = z[125]*U1*z[19];
  z[188] = z[184] + 0.48*z[29]*z[183];
  z[193] = z[188] + 0.1122*U2*(z[7]*z[52]*z[20]+z[7]*z[52]*z[26]+z[8]*z[48]*
  z[20]+z[8]*z[48]*z[26]+z[41]*z[48]*z[19]-z[43]*z[52]*z[19]);
  z[197] = z[15]*U3*(z[20]+z[26]);
  z[365] = z[14]*z[263] + z[14]*z[278] + z[48]*z[290] + z[48]*z[300] + z[52]*
  z[294] + z[52]*z[299] + z[52]*z[316] + z[52]*z[323] + z[77]*z[311] + z[77]*
  z[324] + z[84]*z[321] + z[84]*z[322] + z[84]*z[348] + z[84]*z[349] + z[114]*
  z[336] + z[114]*z[351] + z[120]*z[342] + z[120]*z[350] + 0.021825*MC*(
  20.61855670103093*z[127]*z[180]+45.81901489117983*z[128]*z[178]+z[29]*
  z[127]*z[183]+2.222222222222222*z[27]*z[128]*z[183]) + 0.042*ME*(23.80952380952381*
  z[143]*z[202]+23.80952380952381*z[146]*z[200]+23.80952380952381*z[149]*
  z[201]+z[9]*z[143]*z[204]-z[9]*z[146]*z[203]-z[10]*z[143]*z[203]-z[10]*
  z[146]*z[204]) + 0.048*MF*(z[143]*z[219]+20.83333333333333*z[143]*z[215]+
  20.83333333333333*z[166]*z[212]+20.83333333333333*z[169]*z[214]+z[10]*
  z[143]*z[217]+z[88]*z[166]*z[217]+z[89]*z[166]*z[218]-z[9]*z[143]*z[218]-
  z[11]*z[169]*z[216]-z[12]*z[166]*z[216]-z[90]*z[169]*z[217]-z[91]*z[169]*
  z[218]) - MB*z[14]*(4.336808689942018E-19*z[174]-0.00387*z[3]*z[175]-0.0009*
  z[4]*z[175]) - 0.05049*MD*(z[27]*z[127]*z[196]+2.222222222222222*z[7]*
  z[138]*z[194]+2.222222222222222*z[8]*z[137]*z[194]+2.222222222222222*z[41]*
  z[137]*z[196]+2.222222222222222*z[42]*z[138]*z[195]-19.80590215884334*
  z[137]*z[190]-19.80590215884334*z[138]*z[192]-8.912655971479502*z[127]*
  z[193]-z[127]*z[197]-2.222222222222222*z[40]*z[137]*z[195]-2.222222222222222*
  z[43]*z[138]*z[196]-z[29]*z[127]*z[195]);
  z[393] = z[247] - z[365];
  z[405] = z[398]*z[392] - z[393];
  z[453] = z[421] - z[446]*z[405];
  z[248] = TF5*z[7]*z[15] + 0.1122*z[223]*(z[15]*z[28]-4.278074866310161*
  z[41]*z[53]-4.278074866310161*z[43]*z[49]) + 0.48*z[224]*(2.083333333333334*
  z[43]*z[150]-2.083333333333334*z[67]*z[147]-z[69]*z[144]) - TF3*z[15] - TF6*
  z[15]*z[61] - 0.0485*z[222]*z[15]*z[28] - z[15]*(TF5*z[7]-TF6*z[61]) - 0.48*
  z[225]*(z[69]*z[144]+2.083333333333334*z[101]*z[167]+2.083333333333334*
  z[103]*z[170]);
  z[372] = z[15]*z[278] + z[49]*z[290] + z[49]*z[300] + z[53]*z[294] + z[53]*
  z[299] + z[53]*z[316] + z[53]*z[323] + z[78]*z[311] + z[78]*z[324] + z[85]*
  z[321] + z[85]*z[322] + z[85]*z[348] + z[85]*z[349] + z[115]*z[336] + 
  z[115]*z[351] + z[121]*z[342] + z[121]*z[350] + 0.00235225*MC*z[15]*(20.61855670103093*
  z[178]+z[27]*z[183]) + 0.02016*ME*(23.80952380952381*z[144]*z[202]+49.60317460317459*
  z[147]*z[200]+49.60317460317459*z[150]*z[201]+z[9]*z[144]*z[204]-2.083333333333334*
  z[9]*z[147]*z[203]-2.083333333333334*z[10]*z[147]*z[204]-z[10]*z[144]*
  z[203]) + 0.02304*MF*(z[144]*z[219]+20.83333333333334*z[144]*z[215]+43.40277777777778*
  z[167]*z[212]+43.40277777777778*z[170]*z[214]+z[10]*z[144]*z[217]+2.083333333333334*
  z[88]*z[167]*z[217]+2.083333333333334*z[89]*z[167]*z[218]-2.083333333333334*
  z[11]*z[170]*z[216]-2.083333333333334*z[12]*z[167]*z[216]-2.083333333333334*
  z[90]*z[170]*z[217]-2.083333333333334*z[91]*z[170]*z[218]-z[9]*z[144]*
  z[218]) + 0.01258884*MD*(38.12900950365562*z[53]*z[190]+z[15]*z[28]*z[196]+
  4.278074866310161*z[7]*z[49]*z[194]+4.278074866310161*z[40]*z[53]*z[195]+
  4.278074866310161*z[42]*z[49]*z[195]+8.912655971479502*z[8]*z[15]*z[192]-
  38.12900950365562*z[49]*z[192]-8.912655971479502*z[7]*z[15]*z[190]-4.278074866310161*
  z[8]*z[53]*z[194]-4.278074866310161*z[41]*z[53]*z[196]-4.278074866310161*
  z[43]*z[49]*z[196]-z[15]*z[27]*z[195]);
  z[394] = z[248] - z[372];
  z[413] = z[406]*z[392] - z[394];
  z[445] = z[413] - z[438]*z[405];
  z[477] = z[453] - z[470]*z[445];
  z[250] = 0.042*z[224]*z[17]*z[67] - TF5*z[17] - 0.048*z[225]*(1.458333333333334*
  z[101]*z[118]-1.458333333333334*z[103]*z[112]-z[17]*z[67]);
  z[385] = z[112]*z[336] + z[112]*z[351] + z[118]*z[342] + z[118]*z[350] + 
  z[17]*(z[316]+z[323]) - 0.001764*ME*z[17]*(23.80952380952381*z[200]-z[9]*
  z[203]-z[10]*z[204]) - 0.002304*MF*(30.38194444444445*z[112]*z[214]+z[9]*
  z[17]*z[217]+z[10]*z[17]*z[218]+1.458333333333334*z[12]*z[118]*z[216]+
  20.83333333333334*z[11]*z[17]*z[212]-30.38194444444445*z[118]*z[212]-20.83333333333334*
  z[12]*z[17]*z[214]-1.458333333333334*z[11]*z[112]*z[216]-1.458333333333334*
  z[88]*z[118]*z[217]-1.458333333333334*z[89]*z[118]*z[218]-1.458333333333334*
  z[90]*z[112]*z[217]-1.458333333333334*z[91]*z[112]*z[218]);
  z[396] = z[250] - z[385];
  z[429] = z[422]*z[392] - z[396];
  z[461] = z[429] - z[454]*z[405];
  z[485] = z[461] - z[478]*z[445];
  z[501] = z[485] - z[494]*z[477];
  z[251] = TF6*z[18];
  z[391] = z[18]*(z[348]+z[349]);
  z[397] = -z[251] - z[391];
  z[437] = z[430]*z[392] - z[397];
  z[469] = z[437] - z[462]*z[405];
  z[493] = z[469] - z[486]*z[445];
  z[509] = z[493] - z[502]*z[477];
  z[517] = z[509] - z[510]*z[501];
  z[524] = z[517]/z[511];
  z[531] = (z[501]-z[496]*z[524])/z[495];
  z[538] = (z[477]-z[472]*z[531]-z[473]*z[524])/z[471];
  z[545] = (z[445]-z[440]*z[538]-z[441]*z[531]-z[442]*z[524])/z[439];
  z[552] = (z[405]-z[400]*z[545]-z[401]*z[538]-z[402]*z[531]-z[403]*z[524])/
  z[399];
  z[559] = (z[392]-z[353]*z[538]-z[354]*z[552]-z[355]*z[545]-z[356]*z[531]-
  z[357]*z[524])/z[352];
  z[518] = z[18]/z[511];
  z[530] = z[496]*z[518]/z[495];
  z[536] = (z[472]*z[530]-z[473]*z[518])/z[471];
  z[542] = (z[441]*z[530]-z[440]*z[536]-z[442]*z[518])/z[439];
  z[548] = (z[402]*z[530]-z[400]*z[542]-z[401]*z[536]-z[403]*z[518])/z[399];
  z[554] = (z[356]*z[530]-z[353]*z[536]-z[354]*z[548]-z[355]*z[542]-z[357]*
  z[518])/z[352];
  U1p = T1*z[553] + T2*z[555] + T3*z[556] + T4*z[557] + T5*z[558] + z[559] - 
  T6*z[554];
  U2p = T1*z[547] + T3*z[549] + T4*z[550] + T5*z[551] + z[552] - T2*z[546] - 
  T6*z[548];
  U3p = T1*z[540] + T2*z[541] + T4*z[543] + T5*z[544] + z[545] - T3*z[539] - 
  T6*z[542];
  U4p = T1*z[533] + T2*z[534] + T3*z[535] + T5*z[537] + z[538] - T4*z[532] - 
  T6*z[536];
  U5p = T1*z[526] + T2*z[527] + T3*z[528] + T4*z[529] + T6*z[530] + z[531] - 
  T5*z[525];
  U6p = T1*z[519] + T2*z[520] + T3*z[521] + T4*z[522] + T5*z[523] + z[524] - 
  T6*z[518];
}
